

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ism3d.maths.stats.custom_sf &mdash; ism3d 0.3.dev1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ism3d.maths.stats.pdf2rv" href="ism3d.maths.stats.pdf2rv.html" />
    <link rel="prev" title="ism3d.maths.stats.custom_rvs" href="ism3d.maths.stats.custom_rvs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ism3d
          

          
          </a>

          
            
            
              <div class="version">
                0.3.dev1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Specification/Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/inpfile.html">Parameter File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/keywords.html">Keywords</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../develop/background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/goals.html">Design Goals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/ack.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/seealso.html">See also</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/dictionary.html">ISM3D Dictionary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/callgraph.html">ISM3D call graph</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials: Direct API Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_api_uvhelper.html">ism3d.uvhelper: visibility imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_api_arts.html">ism3d.arts: model artificial sources in different shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_api_lens.html">ism3d.arts.lens: model artificial sources with gravitational lensing effects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_api_maskmoment.html">ism3d.xyhelper.maskmoment: derive moment0/moment1 maps from spectral cubes</a></li>
</ul>
<p class="caption"><span class="caption-text">Benchmarking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../benchmark/demo_invert_ft.html">Invert</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/test_uvsample_performance.html">Test the performance of the Image-to-MS-related modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials: Modeling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_b4c2_uv_ab.html">Example BX610: perform model fitting using method=‘amoeba’ for the Band 4 Cycle 2 DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_b4c5_uv_ab.html">Example BX610: perform model fitting using method=‘amoeba’ for the Band 4 Cycle 5 DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_b6c3_uv_ab.html">Example BX610: perform model fitting using method=‘amoeba’ for the Band 6 Cycle 3 DataSet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_model_1dspec.html">Invert Visibility + Plot 1D spectra (may take a while)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_emcee.html">Example BX610: perform model fitting using method=‘emcee’</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_hxmm01_simulate.html">Example HXMM01: test the MS-simulation modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials: misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_notebook.html">Tutorials &amp; Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials: Data Preparation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_gn20_prep.html">Example: GN20 (z~4 SMF) : Data Prep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_prep.html">Example: BX610 (High-z SFG) : Data Prep</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_hxmm01_prep.html">Example: HXMM01 (High-z Merger)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_gn20_imaging.html">Example GN20: perform imaging of CO 2-1 dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../demos/demo_bx610_imaging.html">Example: BX610 (High-z SFG) : Data Imaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/demo_notebook.html">Tutorials &amp; Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="ism3d.html">ism3d</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ism3d.arts.html">ism3d.arts</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.interface.html">ism3d.interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.ism3d.html">ism3d.ism3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.logger.html">ism3d.logger</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="ism3d.maths.html">ism3d.maths</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ism3d.maths.geometry.html">ism3d.maths.geometry</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="ism3d.maths.stats.html">ism3d.maths.stats</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.cdf2rv.html">ism3d.maths.stats.cdf2rv</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.custom_pdf.html">ism3d.maths.stats.custom_pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.custom_ppf.html">ism3d.maths.stats.custom_ppf</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.custom_rvs.html">ism3d.maths.stats.custom_rvs</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">ism3d.maths.stats.custom_sf</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.pdf2rv.html">ism3d.maths.stats.pdf2rv</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.pdf2rv_nd.html">ism3d.maths.stats.pdf2rv_nd</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.rng_seeded.html">ism3d.maths.stats.rng_seeded</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.expon2d_gen.html">ism3d.maths.stats.expon2d_gen</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.laplace_gen.html">ism3d.maths.stats.laplace_gen</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.norm2d_gen.html">ism3d.maths.stats.norm2d_gen</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.sechsq_gen.html">ism3d.maths.stats.sechsq_gen</a></li>
<li class="toctree-l4"><a class="reference internal" href="ism3d.maths.stats.sersic2d_gen.html">ism3d.maths.stats.sersic2d_gen</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.modeling.html">ism3d.modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.simuv.html">ism3d.simuv</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.simxy.html">ism3d.simxy</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.utils.html">ism3d.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.uvhelper.html">ism3d.uvhelper</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.visualize.html">ism3d.visualize</a></li>
<li class="toctree-l2"><a class="reference internal" href="ism3d.xyhelper.html">ism3d.xyhelper</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ism3d</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="ism3d.html">ism3d</a> &raquo;</li>
        
          <li><a href="ism3d.maths.html">ism3d.maths</a> &raquo;</li>
        
          <li><a href="ism3d.maths.stats.html">ism3d.maths.stats</a> &raquo;</li>
        
      <li>ism3d.maths.stats.custom_sf</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="ism3d-maths-stats-custom-sf">
<h1>ism3d.maths.stats.custom_sf<a class="headerlink" href="#ism3d-maths-stats-custom-sf" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="ism3d.maths.stats.custom_sf">
<code class="sig-prename descclassname">ism3d.maths.stats.</code><code class="sig-name descname">custom_sf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">sersic_n</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/ism3d/maths/stats.html#custom_sf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#ism3d.maths.stats.custom_sf" title="Permalink to this definition">¶</a></dt>
<dd><p>The relation between x and q (i.e. CDF) is used to transfer uniform standard random variables to the desired sampling
for a specified PDF. If .ppf can be writtten in analytical forms, we can call funtions to directly calculate.
However, if special functions are involved, the computation cost can be high and an pre-calculated transform table
can be used.</p>
<p>To Keep numerical precision and meet the sampling gridding error requirementaion (that is the sampling transfer error
in X_{i} is smaller than pixel size / bin size. It’s easier to build the table from a regular oversamped grid in x,
then calculate the crosspoding p value (within 0~1). Of course the regular oversamped x value can not go to +finity,
and an upper limit should be given:</p>
<blockquote>
<div><dl class="simple">
<dt>e.g. x_grid=np.linspace(0,100,10000) may be good enought for “expon2d”,</dt><dd><p>this means the transfered x from interpolated should have error(x)&lt;=0.01Re (as we use linear interp to
replace the actual curve), withinin 100Re (more than
enought for our modeling accuray)</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>However, another numerical problem may occare as large x may lead to very close to 1 in this case, and numercial</dt><dd><p>accurcy may degrade lead to 1: see:
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.rv_continuous.html</a>
note on _logsf
and the test_custom_ppf_learn(): x=100 will lead to q=1 rather than something cose to zero.</p>
</dd>
</dl>
<p>The solution is calculate sf=1-q=1-CDF or logsf=log(1-q)=log(1-CDF);
then the small deviation from 1 can still be acturrately represented numerically. And we can use x vs. logsf table to transfer ur to x-domain acurrate enought for gridding purpose</p>
<dl class="simple">
<dt>The computer is good at saving small number close to zero rather than a number very close to one.</dt><dd><p><a class="reference external" href="https://scicomp.stackexchange.com/questions/20629/when-should-log1p-and-expm1-be-used">https://scicomp.stackexchange.com/questions/20629/when-should-log1p-and-expm1-be-used</a></p>
</dd>
</dl>
<p>note: the interplation method is only used for the transform in which the calculatione becomes to expensive</p>
<dl class="simple">
<dt>The inverse function x=isf(sf):</dt><dd><p>if sf is a uniform (0-1) random variable, then x should follow the desired distribution</p>
</dd>
</dl>
<p>use sf instead of CDF is for numerical precsion purpose.</p>
<p>We only use this to build interpolation table for expensive case; so only func=’expon2d’ &amp; ‘sersic2d’
are implemented.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ism3d.maths.stats.pdf2rv.html" class="btn btn-neutral float-right" title="ism3d.maths.stats.pdf2rv" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ism3d.maths.stats.custom_rvs.html" class="btn btn-neutral float-left" title="ism3d.maths.stats.custom_rvs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Rui Xue

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>